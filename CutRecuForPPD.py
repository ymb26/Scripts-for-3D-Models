path = r'C:\1\Cut_files\RECU_216_Kust_NewFrac_110bar_more!_pravka.txt'
path_out = r'C:\1\Cut_files\RECU_216_Kust_NewFrac_110bar_more!_pravka_cut.txt'
path_out_sort = r'C:\1\RECU_FULL_MODEL_cut_sort.TXT'

#wells = ["43724", "42934G", "22102G", "22105G", "42935G", "22137", "22110G", "22127", "42964", "22108G", "22126", "22115G", "22157", "poz-4", "22129", "22114G", "poz-9", "22113G", "22120", "22122", "21615G", "22126G", "22005", "22121G", "22011", "22138", "22015", "22143", "22016", "22140", "22133", "22020", "22132", "22144", "22023", "22037", "22024", "22131", "22130", "22040", "22038", "22021"]
#data = ["22.08.2024", "25.12.2024", "13.02.2025", "28.03.2025", "10.04.2025", "11.09.2025", "26.10.2025", "08.12.2025", "10.01.2026", "15.02.2026", "03.07.2026", "09.08.2026", "16.08.2026", "10.09.2026", "20.09.2026", "13.01.2027", "20.01.2027", "23.02.2027", "27.06.2027", "20.09.2027", "24.01.2028", "23.02.2028", "27.02.2028", "28.07.2028", "01.08.2028", "09.11.2028", "04.01.2029", "21.02.2029", "25.02.2029", "14.04.2029", "05.06.2029", "21.09.2029", "08.11.2029", "30.12.2029", "03.01.2030", "24.02.2030", "08.06.2030", "16.09.2030", "07.11.2030", "02.01.2031", "08.11.2032", "30.12.2032"]

#wells = ["22126", "22157", "22129", "22001", "22006", "22005", "22011", "22012", "22013", "22015", "22016", "22018", "22020", "22023", "22037", "22024", "22027", "22040", "22029", "22030", "22033", "22036", "22035", "22038", "22021", "22120", "22127", "22113G", "22114G", "22115G", "22122", "22137", "22130", "22131", "22132", "22133", "22138", "22140", "22102G", "22105G", "22108G", "22110G", "22143", "22144", "22121G", "22126G", "21602G", "21607G", "21605G", "21606G", "21611G", "21612G", "21615G", "21617G", "21619G", "21620G", "43724", "42934G", "42935G", "42960G", "42937BGS", "21501G", "42964", "POZ-4", "POZ-9", "POZ-7"]
#data = ["03.07.2026", "16.08.2026", "20.09.2026", "07.01.2027", "12.06.2027", "27.02.2028", "01.08.2028", "22.09.2028", "13.11.2028", "04.01.2029", "25.02.2029", "09.06.2029", "21.09.2029", "03.01.2030", "24.02.2030", "08.06.2030", "30.07.2030", "02.01.2031", "16.04.2031", "19.09.2031", "22.02.2032", "05.06.2032", "27.07.2032", "08.11.2032", "30.12.2032", "27.06.2027", "08.12.2025", "23.02.2027", "13.01.2027", "09.08.2026", "20.09.2027", "11.09.2025", "07.11.2030", "16.09.2030", "08.11.2029", "05.06.2029", "09.11.2028", "14.04.2029", "13.02.2025", "28.03.2025", "15.02.2026", "26.10.2025", "21.02.2029", "30.12.2029", "28.07.2028", "23.02.2028", "06.07.2026", "11.11.2026", "28.12.2026", "05.02.2027", "14.05.2027", "30.09.2027", "24.01.2028", "03.05.2028", "11.08.2028", "30.09.2028", "22.08.2024", "25.12.2024", "10.04.2025", "30.05.2025", "27.08.2025", "25.09.2025", "10.01.2026", "10.09.2026", "20.01.2027", "18.04.2027"]

wells = ["43724", "43935G", "42937BGS", "21602G", "22115G", "21607G", "21605G", "22114G", "POZ-9", "21606G", "22113G", "POZ-7", "21611G", "21612G", "21615G", "21617G", "22121G", "21619G", "21620G"]
data = ["22.08.2024", "10.04.2025", "27.08.2025", "06.07.2026", "09.08.2026", "11.11.2026", "28.12.2026", "13.01.2027", "20.01.2027", "05.02.2027", "23.02.2027", "18.04.2027", "14.05.2027", "30.09.2027", "24.01.2028", "03.05.2028", "28.07.2028", "11.08.2028", "30.09.2028"]

from datetime import datetime
import pandas as pd

df = pd.read_csv(path, delimiter='\t', header=0)
print(df)
df['WELL'] = pd.to_datetime(df['WELL'], format="%d.%m.%Y", exact=False)
df['WELL2'] = df['WELL'].dt.strftime('%d.%m.%Y')
#print(df)
file = open(path_out, 'w')
file.write("EFORM\tWELL\t\'DD.MM.YYYY\'\tMDL\tMDU\tRAD\tSKIN\n")
file.write("ETAB\n\n")
file.close()
all_wells = df['EFORM'].unique()
diff = list(set(all_wells) - set(wells))
#print(wells)
#print(diff)

#'''
for d, w in zip(data, wells):
    ## cut wells in list whick we need to cut. Need to check on wells which have a date after
    #print(df.loc[(df['EFORM'] == w) & (df['WELL'] < datetime.strptime(d, '%d.%m.%Y')), ['EFORM', 'WELL2', '\'DD.MM.YYYY\'', 'MDL', 'MDU', 'RAD', 'SKIN']])
    df.loc[(df['EFORM'] == w) & (df['WELL'] < datetime.strptime(d, '%d.%m.%Y')), ['EFORM', 'WELL2', '\'DD.MM.YYYY\'', 'MDL', 'MDU', 'RAD', 'SKIN']].to_csv(path_out, mode='a', index=False, header = False, sep='\t', columns=None)
    print("Change - ", w, "new date - ", w)
for d in diff:
    df.loc[df['EFORM'] == d, ['EFORM', 'WELL2', '\'DD.MM.YYYY\'', 'MDL', 'MDU', 'RAD', 'SKIN']].to_csv(path_out, mode='a', index=False, header = False, sep='\t', columns=None)
    print(d, end=" ")

with open(path_out, 'a') as file:
    file.write("\nENDE\n")

'''
with open(path_out_sort, 'w') as f:
    f.write("EFORM\tWELL\t\'DD.MM.YYYY\'\tMDL\tMDU\tRAD\tSKIN\n")
    f.write("ETAB\n\n")

df2 = pd.read_csv(path, delimiter='\t')

df2['WELL'] = pd.to_datetime(df2['WELL'], format="%d.%m.%Y")
df2['WELL2'] = df2['WELL'].dt.strftime('%d.%m.%Y')
df2 = df2.sort_values(axis=0, by=['WELL'], ascending=True, kind='mergesort')
df2.to_csv(path_out_sort, mode='a', index=False, sep='\t', columns=['EFORM', 'WELL2', '\'DD.MM.YYYY\'', 'MDL', 'MDU', 'RAD', 'SKIN'], header=False)
with open(path_out_sort, 'a') as f:
    f.write("\nENDE\n")
#print(df2)
'''