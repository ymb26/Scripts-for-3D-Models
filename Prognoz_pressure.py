from datetime import datetime
from datetime import timedelta, date
from dateutil.relativedelta import relativedelta

#wells = ["22101", "22106", "22111", "22127", "22137", "42929", "42962", "42963", "42964", "42965", "42966", "42967", "42968", "43723", "43724", "21501", "22102", "22103", "22104", "22105", "22108", "22109", "22110", "22155ST2", "42930G", "42931G", "42932G", "42933G", "42934G", "42935G", "42936G", "42958G", "42959G", "42960G", "43785G"]
#dates = ["27.12.2022", "03.06.2022", "22.07.2022", "08.12.2022", "11.09.2022", "23.05.2021", "03.03.2023", "29.01.2023", "11.01.2023", "12.10.2022", "30.11.2022", "30.11.2022", "30.11.2022", "28.08.2021", "23.08.2021", "26.09.2022", "13.02.2022", "27.01.2022", "01.02.2022", "28.03.2022", "15.02.2023", "23.03.2023", "30.11.2022", "01.04.2023", "10.06.2021", "17.07.2021", "21.09.2021", "17.11.2021", "26.12.2021", "11.04.2022", "26.04.2022", "21.04.2022", "18.08.2022", "31.05.2022", "19.01.2023"]

##last_correct
#wells = ["22101", "22106", "22111", "22127", "22137", "42929", "42962", "42963", "42964", "42965", "42966", "42967", "42968", "43723", "43724", "21501G", "22102G", "22103G", "22104G", "22105G", "22108G", "22109G", "22110", "22155ST2", "42930G", "42931G", "42932G", "42933G", "42934G", "42935G", "42936G", "42958G", "42959G", "42960G", "43785G"]
#dates = ["04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023"]
#pressures = [124.9521561, 96.65377808, 132, 110.7646103, 204.2450104, 92.80039978, 162.8215179, 137.6919708, 58.37256241, 192.7380524, 131.3585205, 134.7818146, 82.91693878, 213.4034119, 119.3003464, 93.30368805, 98.42136383, 77.13788605, 138.807251, 108.2489243, 130.151535, 166.0545044, 125.1891403, 143.983551, 141.2476807, 133.807373, 77.93759918, 155.445327, 168.6804047, 170.2246094, 146.016815, 132.1716156, 129.3565369, 0, 234.364563]

##prognoz_correct
wells = ["20301", "21501G", "215Z", "22101", "22102G", "22103G", "22104G", "22105G", "22106", "22108G", "22109G", "22110G", "22111", "22127", "22137", "22155ST2", "42929", "42930G", "42931G", "42932G", "42933G", "42934G", "42935G", "42936G", "42937BGS", "42937G", "42958G", "42959G", "42960G", "42962", "42963", "42964", "42965", "42966", "42967", "42968", "43723", "43724", "43785G"]
dates = ["04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023", "04.05.2023"]
pressures = [0, 91.57633972, 0, 123.3782806, 98.50511169, 73.79946136, 138.4616699, 105.4914093, 86.70623779, 129.5284119, 166.3084564, 99.78622437, 139.8182373, 40, 159.0482941, 144.0260773, 77.64125824, 140.4544373, 128.2588043, 76.62572479, 154.2169189, 168.6048126, 169.7306824, 145.2509613, 0, 0, 131.7424164, 128.3909149, 0, 147.9062958, 135.1276703, 40, 179.400116, 133.851181, 137.6338501, 76.06667328, 204.0874786, 146.7918549, 222.2789459]


limit_pressure = 50
file_out = open(r'C:\1\1_Field\%s.txt' % limit_pressure, 'w')
for w, d, p in zip(wells, dates, pressures):
    new_d = datetime.strptime(d, "%d.%m.%Y") + relativedelta(days=1)
    if p > limit_pressure:
        while p > limit_pressure:
            print(w, new_d, "OPEN\tPROD\tBHPT\t", "{:.5f}".format(p))
            file_out.write(w + '\t' + str(new_d) + "\tOPEN\tPROD\tBHPT\t" + "{:.5f}".format(p) + '\n')
            #new_d = new_d + relativedelta(months=1, day=new_d.day)
            new_d = new_d + relativedelta(days=1)
            p -= 0.06452
        print(w, new_d, "OPEN\tPROD\tBHPT\t", limit_pressure)
        file_out.write(w + '\t' + str(new_d) + "\tOPEN\tPROD\tBHPT\t" + str(limit_pressure) + '\n')
    elif p < 2:
        continue
    else:
        print(w, new_d, "OPEN\tPROD\tBHPT\t", "{:.5f}".format(p - 2))
        file_out.write(w + '\t' + str(new_d) + "\tOPEN\tPROD\tBHPT\t" + "{:.5f}".format(p - 2) + '\n')

